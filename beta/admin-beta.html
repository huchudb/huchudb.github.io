<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Huchu Admin (Beta)</title>

  <!-- (선택) 공통 스타일이 있다면 유지 -->
  <!-- <link rel="stylesheet" href="/assets/styles.css?v=20251223" /> -->

  <link rel="stylesheet" href="/assets/admin-beta.css?v=20251223-clean1" />
</head>
<body>

  <div class="admin-page">

    <div class="beta-menu">
      <button id="betaMenuToggle" class="beta-menu-toggle" type="button" aria-expanded="false">
        메뉴
      </button>
      <div id="betaMenuPanel" class="beta-menu-panel hide" role="menu">
        <a href="/beta/index.html">베타 홈</a>
        <a href="/beta/ontu-stats.html">온투 통계</a>
        <a href="/beta/admin-beta.html">관리자</a>
      </div>
    </div>

    <h1 class="admin-title">Huchu Admin (Beta)</h1>
    <p class="admin-note">
      - 통계 저장은 월별로 관리됩니다.<br>
      - 온투업체 설정은 서버 저장 + 로컬 자동 백업을 병행합니다.
    </p>

    <div class="admin-tabs">
      <button class="admin-tab-btn is-active" type="button" data-tab="stats">온투 통계</button>
      <button class="admin-tab-btn" type="button" data-tab="lenders">온투업체 설정</button>
    </div>

    <!-- ===================== TAB: STATS ===================== -->
    <section id="admin-tab-stats" class="admin-tab-panel">
      <div class="admin-card">
        <div class="admin-field-group">
          <h2 class="admin-field-title">1) 조회년월</h2>
          <div class="admin-field">
            <label for="statsMonth">조회년월</label>
            <input id="statsMonth" class="admin-input" type="month" />
          </div>
        </div>

        <div class="admin-field-group">
          <h2 class="admin-field-title">2) 요약</h2>
          <div class="admin-field-grid">
            <div class="admin-field">
              <label for="statsRegisteredFirms">등록 업체수</label>
              <input id="statsRegisteredFirms" class="admin-input" type="number" min="0" />
            </div>

            <div class="admin-field">
              <label for="statsDataFirms">데이터 반영 업체수</label>
              <input id="statsDataFirms" class="admin-input" type="number" min="0" />
            </div>

            <div class="admin-field">
              <label for="statsTotalLoan">누적 대출액(원)</label>
              <input id="statsTotalLoan" class="admin-input" type="text" data-type="money" />
            </div>

            <div class="admin-field">
              <label for="statsTotalRepaid">누적 상환액(원)</label>
              <input id="statsTotalRepaid" class="admin-input" type="text" data-type="money" />
            </div>

            <div class="admin-field">
              <label for="statsBalance">대출잔액(원) (byLender 분모/수동)</label>
              <input id="statsBalance" class="admin-input" type="text" data-type="money" />
            </div>
          </div>
        </div>

        <div class="admin-field-group">
          <h2 class="admin-field-title">3) 상품유형별 대출잔액</h2>

          <div class="admin-subbox">
            <table class="admin-table">
              <thead>
                <tr>
                  <th>상품유형</th>
                  <th style="text-align:right;">비율(%)</th>
                  <th style="text-align:right;">잔액(원)</th>
                </tr>
              </thead>
              <tbody id="productRows">
                <!-- JS가 data-key 행들을 읽는다 -->
                <tr data-key="부동산담보대출">
                  <td>부동산담보대출</td>
                  <td><input class="admin-input js-ratio admin-input-right" type="text" /></td>
                  <td><input class="admin-input js-amount admin-input-right" type="text" data-type="money" /></td>
                </tr>
                <tr data-key="개인신용대출">
                  <td>개인신용대출</td>
                  <td><input class="admin-input js-ratio admin-input-right" type="text" /></td>
                  <td><input class="admin-input js-amount admin-input-right" type="text" data-type="money" /></td>
                </tr>
                <tr data-key="스탁론(상장)">
                  <td>스탁론(상장)</td>
                  <td><input class="admin-input js-ratio admin-input-right" type="text" /></td>
                  <td><input class="admin-input js-amount admin-input-right" type="text" data-type="money" /></td>
                </tr>
                <tr data-key="스탁론(비상장)">
                  <td>스탁론(비상장)</td>
                  <td><input class="admin-input js-ratio admin-input-right" type="text" /></td>
                  <td><input class="admin-input js-amount admin-input-right" type="text" data-type="money" /></td>
                </tr>
                <tr data-key="법인신용대출">
                  <td>법인신용대출</td>
                  <td><input class="admin-input js-ratio admin-input-right" type="text" /></td>
                  <td><input class="admin-input js-amount admin-input-right" type="text" data-type="money" /></td>
                </tr>
                <tr data-key="매출채권유동화">
                  <td>매출채권유동화</td>
                  <td><input class="admin-input js-ratio admin-input-right" type="text" /></td>
                  <td><input class="admin-input js-amount admin-input-right" type="text" data-type="money" /></td>
                </tr>
                <tr data-key="의료사업자대출">
                  <td>의료사업자대출</td>
                  <td><input class="admin-input js-ratio admin-input-right" type="text" /></td>
                  <td><input class="admin-input js-amount admin-input-right" type="text" data-type="money" /></td>
                </tr>
                <tr data-key="온라인선정산">
                  <td>온라인선정산</td>
                  <td><input class="admin-input js-ratio admin-input-right" type="text" /></td>
                  <td><input class="admin-input js-amount admin-input-right" type="text" data-type="money" /></td>
                </tr>
                <tr data-key="전자어음">
                  <td>전자어음</td>
                  <td><input class="admin-input js-ratio admin-input-right" type="text" /></td>
                  <td><input class="admin-input js-amount admin-input-right" type="text" data-type="money" /></td>
                </tr>
                <tr data-key="경매배당금담보대출">
                  <td>경매배당금담보대출</td>
                  <td><input class="admin-input js-ratio admin-input-right" type="text" /></td>
                  <td><input class="admin-input js-amount admin-input-right" type="text" data-type="money" /></td>
                </tr>
                <tr data-key="미술품담보대출">
                  <td>미술품담보대출</td>
                  <td><input class="admin-input js-ratio admin-input-right" type="text" /></td>
                  <td><input class="admin-input js-amount admin-input-right" type="text" data-type="money" /></td>
                </tr>
                <!-- 합계 행은 JS가 자동 삽입 -->
              </tbody>
            </table>
          </div>
        </div>

        <button id="saveOntuStatsBtn" class="admin-save-btn" type="button">통계 저장</button>
        <div id="statsSaveStatus" class="admin-save-status"></div>
      </div>
    </section>

    <!-- ===================== TAB: LENDERS ===================== -->
    <section id="admin-tab-lenders" class="admin-tab-panel hide">
      <div class="admin-card">
        <div class="admin-field-group">
          <h2 class="admin-field-title">온투업체 설정</h2>

          <div class="admin-field">
            <label for="lenderSearchInput">업체 검색</label>
            <input id="lenderSearchInput" class="admin-input" type="text" placeholder="이름/ID 검색" />
          </div>

          <div class="admin-field" style="gap:10px;">
            <div style="display:flex; gap:10px; flex-wrap:wrap;">
              <button id="downloadLoanConfigBtn" class="admin-save-btn" type="button">백업 다운로드</button>
              <button id="uploadLoanConfigBtn" class="admin-save-btn" type="button">백업 업로드</button>
              <input id="loanConfigFileInput" type="file" accept="application/json" class="hide" />
            </div>
            <div id="lendersBackupStatus" class="admin-save-status"></div>
          </div>
        </div>

        <div id="lendersList"></div>

        <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-top:12px;">
          <button id="saveLendersConfigBtn" class="admin-save-btn" type="button">전체 저장</button>
          <div id="lendersSaveStatus" class="admin-save-status"></div>
        </div>

        <div class="admin-subbox" style="margin-top:16px;">
          <h3 class="admin-subbox-title">설정 JSON 미리보기</h3>
          <pre id="lendersConfigPreview" style="margin:0; font-size:12px; overflow:auto; max-height:320px;"></pre>
        </div>
      </div>
    </section>

  </div>

  <script defer src="/assets/admin-beta.js?v=20251223-clean1"></script>
</body>
</html>
